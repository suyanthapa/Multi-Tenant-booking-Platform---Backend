// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
}

model Booking {
    id String @id @default(uuid())

    // Ownership
    userId     String @map("user_id")
    vendorId   String @map("vendor_id")
    resourceId String @map("resource_id")

    // Snapshot data
    resourceName   String  @map("resource_name")
    resourceType   String  @map("resource_type")
    vendorName     String  @map("vendor_name")
    priceAtBooking Decimal @map("price_at_booking") @db.Decimal(10, 2)
    currency       String  @default("USD")

    // Booking timing
    bookingDate DateTime @map("booking_date")
    startTime   DateTime @map("start_time")
    endTime     DateTime @map("end_time")

    // State
    status BookingStatus @default(PENDING)

    @@index([userId])
    @@index([vendorId])
    @@index([resourceId])
    @@index([bookingDate])
    @@index([status])
    @@index([resourceId, startTime, endTime]) // overlap checks
    @@map("bookings")
}

enum BookingStatus {
    PENDING
    CONFIRMED
    IN_PROGRESS
    COMPLETED
    CANCELLED
    NO_SHOW
}

model Resource {
    id       String @id @default(uuid())
    vendorId String @map("vendor_id")

    name        String
    type        ResourceType
    description String?

    price    Decimal @db.Decimal(10, 2)
    currency String  @default("USD")

    isActive Boolean @default(true)

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([vendorId])
    @@index([type])
    @@map("resources")
}

enum ResourceType {
    HOTEL_ROOM
    DOCTOR_SLOT
    SALON_CHAIR
    DESK
    OTHER
}
